{% extends 'base.html' %}
{% block title %}Menu Chính{% endblock %}

{% block content %}
<div class="container-fluid py-3 h-100 d-flex flex-column">
    <div class="row mb-3">
        <div class="col-12 text-center">
            <h2 class="fw-bold text-primary mb-0">Hệ Thống K.S Chất Lượng Vải</h2>
            <p class="text-secondary mb-0">Xin chào, <span class="fw-bold text-body-emphasis">{{ username }}</span></p>
        </div>
    </div>

    <div class="row g-3 justify-content-center flex-grow-1 align-content-center">
        
        <div class="col-6 col-md-4 col-xl-3">
            <div class="card h-100 border-0 shadow-sm app-card touch-card">
                <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-3">
                    <div class="icon-box bg-primary-subtle text-primary mb-3">
                        <i class="bi bi-display fs-1"></i>
                    </div>
                    <h5 class="card-title fw-bold mb-1 text-body-emphasis">Kiểm Tra Vải</h5>
                    <span class="badge bg-primary rounded-pill mb-2">Hoạt động chính</span>
                    <a href="{{ url_for('main.select_machine') }}" class="stretched-link"></a>
                </div>
            </div>
        </div>

        <div class="col-6 col-md-4 col-xl-3">
            <div class="card h-100 border-0 shadow-sm app-card touch-card">
                <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-3">
                    <div class="icon-box bg-warning-subtle text-warning mb-3">
                        <i class="bi bi-tools fs-1"></i>
                    </div>
                    <h5 class="card-title fw-bold mb-1 text-body-emphasis">Sửa / Cuộn Lại</h5>
                    <p class="card-text text-secondary small mb-0 d-none d-md-block">Xử lý vải lỗi</p>
                    <a href="{{ url_for('main.repair_menu') }}" class="stretched-link"></a>
                </div>
            </div>
        </div>

        <div class="col-6 col-md-4 col-xl-3">
            <div class="card h-100 border-0 shadow-sm app-card touch-card">
                <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-3">
                    <div class="icon-box bg-success-subtle text-success mb-3">
                        <i class="bi bi-box-seam fs-1"></i>
                    </div>
                    <h5 class="card-title fw-bold mb-1 text-body-emphasis">Quản Lý Pallet</h5>
                    <p class="card-text text-secondary small mb-0 d-none d-md-block">Đóng gói & Xuất kho</p>
                    <a href="{{ url_for('main.manage_pallets_page') }}" class="stretched-link"></a>
                </div>
            </div>
        </div>

        <div class="col-6 col-md-4 col-xl-3">
            <div class="card h-100 border-0 shadow-sm app-card touch-card">
                <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-3">
                    <div class="icon-box bg-info-subtle text-info mb-3">
                        <i class="bi bi-bar-chart-line fs-1"></i>
                    </div>
                    <h5 class="card-title fw-bold mb-1 text-body-emphasis">Báo Cáo</h5>
                    <p class="card-text text-secondary small mb-0 d-none d-md-block">Thống kê sản lượng</p>
                    <a href="{{ url_for('main.production_report') }}" class="stretched-link"></a>
                </div>
            </div>
        </div>
        
        <div class="col-6 col-md-4 col-xl-3">
            <div class="card h-100 border-0 shadow-sm app-card touch-card">
                <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-3">
                    <div class="icon-box bg-secondary-subtle text-secondary mb-3">
                        <i class="bi bi-clock-history fs-1"></i>
                    </div>
                    <h5 class="card-title fw-bold mb-1 text-body-emphasis">Lịch Sử</h5>
                    <p class="card-text text-secondary small mb-0 d-none d-md-block">Tra cứu dữ liệu</p>
                    <a href="{{ url_for('main.inspection_history') }}" class="stretched-link"></a>
                </div>
            </div>
        </div>

         <div class="col-6 col-md-4 col-xl-3">
            <div class="card h-100 border-0 shadow-sm app-card touch-card card-logout">
                <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-3">
                    <div class="icon-box bg-danger-subtle text-danger mb-3">
                        <i class="bi bi-box-arrow-right fs-1"></i>
                    </div>
                    <h5 class="card-title fw-bold text-danger mb-1">Đăng Xuất</h5>
                    <a href="{{ url_for('auth.logout') }}" class="stretched-link"></a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* === BASE STYLES === */
    .icon-box {
        width: 80px;
        height: 80px;
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }

    .touch-card {
        cursor: pointer;
        transition: transform 0.1s, box-shadow 0.1s;
        border-radius: 16px;
        background-color: #ffffff; /* Mặc định Light Mode */
    }

    .touch-card:active {
        transform: scale(0.96);
    }

    .card-logout {
        background-color: #f8f9fa; /* Màu nền nhẹ cho nút logout */
    }

    /* === DARK MODE OPTIMIZATION === */
    /* Tự động kích hoạt khi thiết bị đang ở chế độ tối */
    @media (prefers-color-scheme: dark) {
        
        /* Nền tổng thể */
        body {
            background-color: #121212 !important;
            color: #e0e0e0;
        }

        /* Thẻ Card trong Dark Mode */
        .touch-card {
            background-color: #1e1e1e !important; /* Xám đậm dịu mắt */
            border: 1px solid #333 !important; /* Viền nhẹ để tách biệt */
            box-shadow: 0 4px 6px rgba(0,0,0,0.3) !important;
        }

        /* Hiệu ứng active trong Dark Mode */
        .touch-card:active {
            background-color: #2d2d2d !important;
        }

        /* Nút Logout trong Dark Mode */
        .card-logout {
            background-color: #251e1e !important; /* Hơi đỏ rất nhẹ hoặc xám tối */
        }

        /* Chỉnh lại màu các icon box để không bị quá chói trên nền đen */
        .bg-primary-subtle { background-color: rgba(13, 110, 253, 0.15) !important; color: #6ea8fe !important; }
        .bg-warning-subtle { background-color: rgba(255, 193, 7, 0.15) !important; color: #ffda6a !important; }
        .bg-success-subtle { background-color: rgba(25, 135, 84, 0.15) !important; color: #75b798 !important; }
        .bg-info-subtle    { background-color: rgba(13, 202, 240, 0.15) !important; color: #6edff6 !important; }
        .bg-secondary-subtle { background-color: rgba(108, 117, 125, 0.15) !important; color: #a7acb1 !important; }
        .bg-danger-subtle  { background-color: rgba(220, 53, 69, 0.15) !important; color: #ea868f !important; }

        /* Chữ phụ (text-secondary) sáng lên chút để đọc được */
        .text-secondary {
            color: #adb5bd !important;
        }

        /* Tiêu đề chính */
        .text-body-emphasis {
            color: #ffffff !important;
        }
    }

    @media (max-width: 576px) {
        .icon-box {
            width: 60px;
            height: 60px;
        }
        .icon-box i {
            font-size: 1.5rem !important;
        }
    }
</style>
{% endblock %}